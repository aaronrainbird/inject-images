
var a = 0;
var i = 0;
var l = 0;

var subSite = "";
var site = "";
var loadPIDs = 0;
var imageClass = "";
var typeOfImages = 0;
var typeOfImagesIndividual = 0;

var arPIDs = [];
var arFulcrumDesignerPIDs = [];
var arFulcrumProductDescriptionPIDs = [];
var arFulcrumProductNotesPIDs = [];
var arFulcrumColourPIDs = [];
var arFulcrumCategoryPIDs = [];
var arFulcrumSubcategoryPIDs = [];
var arDefaultImageTypes = ["desc","in","rw","fr","bk","ou","ou2","ou3","cu","e1","e2","e3","e4","e5","e6","e7","e8","sw"];

siteIdentify();
getPIDs();
console.log(arPIDs.join(','))


/*
imageTypes();
function imageTypes() {
    if (arPIDs.length > 0) {
        loadPIDs = prompt('What PIDs would you like to view on the ' + site + ' site? \n1. All PIDs on Page\n2. User defined PIDs');
    }
    if (loadPIDs == 2) {
        if (arPIDs.length > 0) {
            userDefinedPIDs = prompt('Type multiple 6 digit PIDs below to search them on the ' + site + ' site.\n(Dont worry about removing spaces)',arPIDs.join(','));
        }
        else {
            userDefinedPIDs = prompt('Type multiple 6 digit PIDs below to search them on the ' + site + ' site.\n(Dont worry about removing spaces)');
        }
            userDefinedPIDs = userDefinedPIDs.replace(/mp4/g,''); 
            userDefinedPIDs = userDefinedPIDs.replace(/[^0-9]+/g, '');
            arPIDs = userDefinedPIDs.match(/.{1,6}/g)
    }
        typeOfImages = prompt('What image type would you like to view? \n1. All images \n2. Specific image type');

    if (typeOfImages == 2) {
        typeOfImagesIndividual = prompt('What image type would you like to view? \n1. IN\n2. RW\n3. FR\n4. BK\n5. OU\n6. OU2\n7. OU3\n8. CU\n9. E1\n10. E2\n11. E3\n12. E4\n13. E5\n14. E6\n15. E7\n16. E8\n17. SW');
    }
}

*/

function siteIdentify () {

    if(document.URL.search('net-a-porter') != -1) {
        if(document.URL.search('fulcrum') != -1) {
            subSite = "fulcrum";
        }
        else {
            site = "nap";
        }
    }
    else if (document.URL.search('theoutnet') != -1) {
        site = "ton";
       
    }
    else if (document.URL.search('mrporter') != -1) {
        site = "mrp";    
    }

    if (subSite == "fulcrum") {
        
        if (document.getElementsByClassName('channel_logo')[0] != undefined) {
            clean(document.body);
                if(document.getElementsByClassName('channel_logo')[0].alt.search('OUTNET') != -1)   {
                    site = "ton";
                }
                else if(document.getElementsByClassName('channel_logo')[0].alt.search('MRP') != -1)  {
                    site = "mrp";
                }
                else if(document.getElementsByClassName('channel_logo')[0].alt.search('NAP') != -1) {
                    site = "nap";   
                }
        }
    }

    if (site == "") {

        site = prompt("It doesn't seem that on you're on any of the YNAP brand websites.  What site would you like to search for images? \n1. NAP\n2. The Outnet\n3. Mr Porter");
        loadPIDs = 2;
        switch(site) {
            case "1":
                site = "nap";
                break;
            case "2":
                site = "ton";
                break;
            case "3":
                site = "mrp";
                break;
            default:
                site = "nap";
        }
    }
}



function getPIDs() {
    if (loadPIDs != 2) {     
        if (subSite == "fulcrum") {
            for (l=0; l < document.getElementById('photography_worklist_details').childNodes[0].childNodes[2].childNodes.length; l++) {
    
                if (document.getElementById('photography_worklist_details').childNodes[0].childNodes[2].childNodes[l].childNodes.length > 19) {
                    if (document.getElementById('photography_worklist_details').childNodes[0].childNodes[2].childNodes[l].style.visibility != "collapse") {
                    arPIDs.push(document.getElementById('photography_worklist_details').childNodes[0].childNodes[2].childNodes[l].childNodes[1].childNodes[0].childNodes[1].childNodes[0].childNodes[1].textContent);
                    
                    arFulcrumDesignerPIDs.push(document.getElementById('photography_worklist_details').childNodes[0].childNodes[2].childNodes[l].childNodes[1].childNodes[0].childNodes[0].textContent.trim());   
                    
                    arFulcrumProductDescriptionPIDs.push(document.getElementById('photography_worklist_details').childNodes[0].childNodes[2].childNodes[l].childNodes[1].childNodes[1].childNodes[0].textContent.trim());
                    
                    arFulcrumProductNotesPIDs.push(document.getElementById('photography_worklist_details').childNodes[0].childNodes[2].childNodes[l].childNodes[1].childNodes[2].textContent.trim());       
                        
                    arFulcrumColourPIDs.push(document.getElementById('photography_worklist_details').childNodes[0].childNodes[2].childNodes[l].childNodes[2].childNodes[5].textContent.trim());
    
                    arFulcrumCategoryPIDs.push(document.getElementById('photography_worklist_details').childNodes[0].childNodes[2].childNodes[l].childNodes[2].childNodes[2].textContent.trim());
                        
                    arFulcrumSubcategoryPIDs.push(document.getElementById('photography_worklist_details').childNodes[0].childNodes[2].childNodes[l].childNodes[2].childNodes[0].textContent.trim()); 
                    }
                }
            }
        }
        else if (site == "nap" && document.getElementsByClassName('product-image').length > 0) {
            for (a = 0;a<document.getElementsByClassName('product-image').length;a++) {
                        arPIDs.push(document.getElementsByClassName('product-image')[a].childNodes[1].childNodes[1].src.replace(/^.*[\\\/]/, '').slice(0,6));
            }     
        }
        else if (site == "ton" && document.getElementsByClassName('product-image').length > 0) {
           
            for (a = 0;a<document.getElementsByClassName('product-image').length;a++) {
                        arPIDs.push(document.getElementsByClassName('product-image')[a].dataset.src.replace(/^.*[\\\/]/, '').slice(0,6));
            }      
        }
        else if (site == "mrp") {
            if (document.getElementsByClassName('pl-products-item__link') != undefined) {
                for (a = 0;a<document.getElementsByClassName('pl-products-item__link').length;a++) {
                        arPIDs.push(document.getElementsByClassName('pl-products-item__link')[a].childNodes[0].childNodes[0].src.replace(/^.*[\\\/]/, '').slice(0,6));
                }                
            }
            else if (document.getElementsByClassName('product-image') != undefined) {
                   for (a = 0;a<document.getElementsByClassName('product-image').length;a++) {
                        arPIDs.push(document.getElementsByClassName('product-image')[a].childNodes[1].childNodes[1].src.replace(/^.*[\\\/]/, '').slice(0,6));
                    }
            }
            else {
                loadPIDs = 2;
            }
        }
        else {
            loadPIDs = 2;
        }
    }
}

function clean(node)
{
  for(var n = 0; n < node.childNodes.length;n++)
  {
    var child = node.childNodes[n];
    if
    (
      child.nodeType === 8 
      || 
      (child.nodeType === 3 && !/\S/.test(child.nodeValue))
    )
    {
      node.removeChild(child);
      n --;
    }
    else if(child.nodeType === 1)
    {
      clean(child);
    }
  }
}



makeTable();

function makeTable() {

    var tableHTML = "<button id='myBtn'>Open Modal</button><!-- The Modal --><div id='myModal' class='modal'>  <!-- Modal content -->  <div class='modal-content'>    <span class='close'>&times;</span>    <p>Some text in the Modal..</p>  </div> </div>'"
    var headHTML = "/* The Modal (background) */ .modal {     display: none; /* Hidden by default */    position: fixed; /* Stay in place */    z-index: 1; /* Sit on top */    left: 0;    top: 0;    width: 100%; /* Full width */    height: 100%; /* Full height */    overflow: auto; /* Enable scroll if needed */    background-color: rgb(0,0,0); /* Fallback color */    background-color: rgba(0,0,0,0.4); /* Black w/ opacity */ } /* Modal Content/Box */ .modal-content {  background-color: #fefefe;   margin: 15% auto; /* 15% from the top and centered */    padding: 20px;   border: 1px solid #888;    width: 80%; /* Could be more or less, depending on screen size */ } /* The Close Button */ .close {   color: #aaa;    float: right;    font-size: 28px;    font-weight: bold; } .close:hover, .close:focus {    color: black;    text-decoration: none;    cursor: pointer; }"

var style = document.createElement('style');
var addHTML = document.createElement('div');
style.type = 'text/css';

document.getElementsByTagName('head')[0].appendChild(style);
document.getElementsByTagName('body')[0].appendChild(addHTML);


style.innerHTML = headHTML;
addHTML.innerHTML = tableHTML; 



/*

Here's the Javascript to make it fly.'

// Get the modal
var modal = document.getElementById('myModal');

// Get the button that opens the modal
var btn = document.getElementById("myBtn");

// Get the <span> element that closes the modal
var span = document.getElementsByClassName("close")[0];

// When the user clicks on the button, open the modal
btn.onclick = function() {
    modal.style.display = "block";
}

// When the user clicks on <span> (x), close the modal
span.onclick = function() {
    modal.style.display = "none";
}

// When the user clicks anywhere outside of the modal, close it
window.onclick = function(event) {
    if (event.target == modal) {
        modal.style.display = "none";
    }
}


*/



 
}


/*

var tableHTML = "<!DOCTYPE html><html><HEAD><script>function selectAll() { for (var b = 0;b<document.getElementsByClassName('imageType').length;b++) { document.getElementsByClassName('imageType')[b].checked = true; } } function selectNone() { for (var b = 0;b<document.getElementsByClassName('imageType').length;b++) { document.getElementsByClassName('imageType')[b].checked = false; } } </script></head><body>"

tableHTML += "<textarea class='pids' rows='40' cols='80' style='font-size:16px;background-color: orangered'>" + arPIDs.join(',') + "</textarea><h3>Choose Image Types:</h3><button id='selectAll' onclick='selectAll()'>Select All</button><button id='selectNone' onclick='selectNone()'>Select None</button><BR><BR><input type='checkbox' class='imageType' name='imageType' value='in'>IN<input type='checkbox' class='imageType' name='imageType' value='rw'>RW<input type='checkbox' class='imageType' name='imageType' value='fr'>FR<input type='checkbox' class='imageType' name='imageType' value='bk'>BK<input type='checkbox' class='imageType' name='imageType' value='ou'>OU<input type='checkbox' class='imageType' name='imageType' value='video'>Video<input type='checkbox' class='imageType' name='imageType' value='e1'>E1<input type='checkbox' class='imageType' name='imageType' value='e2'>E2<input type='checkbox' class='imageType' name='imageType' value='e3'>E3<input type='checkbox' class='imageType' name='imageType' value='e4'>E4<input type='checkbox' class='imageType' name='imageType' value='e5'>E5<input type='checkbox' class='imageType' name='imageType' value='e6'>E6<input type='checkbox' class='imageType' name='imageType' value='e7'>E7<input type='checkbox' class='imageType' name='imageType' value='e8'>E8<input type='checkbox' class='imageType' name='imageType' value='e9'>E9<BR><BR>Site to search for PID's: <select size='3' selected='ton'  id='siteDropdown'><option value='nap'>NAP</option><option value='mrp'>MrP</option><option value='ton'>TON</option></select><BR><BR><button class='injectImages' onclick='injectImages()'>Inject Images</button>"  


//Code to link to:







// identify selected value          document.getElementById('siteDropdown').value
// document.getElementsByClassName('imageType')[0].checked = "true"

    tableHTML += "</body></html>"
    
var x = window.open();
x.document.open();
x.document.write(tableHTML);
x.document.close();
// document.getElementById('siteDropdown').value=site;
}


*/









/*

   
}

else {
    
   var typeOfImages = prompt('What image would you like to view? \n1. All Images\n2. Specific Images\n3. User defined PIDs - All Images\n4. User defined PIDs - Specific Images');
if (typeOfImages == 3 || typeOfImages == 4) {
    var userDefinedPIDs = prompt('Type in as many 6 digit pids seperated by a comma as you like to view them.\n(Dont worry about removing spaces)');
} 


var tableHTML = beginHTML();

    if (typeOfImages == 1) {
        for (i = 0; i < document.getElementsByClassName(imageClass).length; i++) {

            var pidNo = findPid();

            for (a = 0; a < arDefaultImageTypes.length;a++) {
                tableCell();
            }
            
            tableHTML += "</tr>";
        }

    }

    else if (typeOfImages == 2)  {

        for (var i = 0; i < document.getElementsByClassName(imageClass).length; i++) {

            var pidNo = findPid();

            if (i > 0 && i % 6 == 0) {
                tableHTML += "</tr><tr>";
            } 

            tableCell();

        }

    tableHTML += "</tr>";

    }

    else if (typeOfImages == 3) {

        userDefinedPIDs = userDefinedPIDs.replace(/\s+/g, '');
        var arUserDefinedPIDs = userDefinedPIDs.split(',');
        
        for (var i = 0; i < arUserDefinedPIDs.length; i++) {
            
          
            
            for (var a = 0; a < arDefaultImageTypes.length;a++) {

               tableCell();

            }                          
            
                
            tableHTML += "</tr>";

        }
    } 
    
    else if (typeOfImages == 4) {

        userDefinedPIDs = userDefinedPIDs.replace(/\s+/g, '');
        var arUserDefinedPIDs = userDefinedPIDs.split(',');
        
        for (i = 0; i < arUserDefinedPIDs.length; i++) {
            
               
              if (i > 0 && i % 6 == 0) {
                tableHTML += "</tr><tr>";
            } 
              
                tableCell();
            }
                
            tableHTML += "</tr>";

     }
    

    else if (typeOfImages == 5) {   //Fulcrum


        for (i = 0; i < arFulcrumPIDs.length; i++) {

            for (a = 0; a < arDefaultImageTypesFulcrum.length;a++) {

               tableCell();

            }
            tableHTML += "</tr>";

        }
    }   
    


tableHTML += "</table>";

    
var x = window.open();
x.document.open();
x.document.write(tableHTML);
x.document.close();

    
function tableCell() {
    if (typeOfImages == 1) {
        tableHTML += "<td class='columns' style='background-color: lightgrey;'><IMG SRC='" + imageFileLocation() + "'><BR>";
        if (site == "mrp") {
            tableHTML += pidNo + "_" + site + "_" + arDefaultImageTypes[a] + "</td>";
        }
        else {
            tableHTML += pidNo + "_" + arDefaultImageTypes[a] + "</td>";
        }
    }        
    else if (typeOfImages == 2) {
        tableHTML += "<td class='columns' style='background-color: lightgrey;'><IMG SRC='" + imageFileLocation() + "'><BR>"; 
        if (site == "mrp") {
            tableHTML += pidNo + "_" + site + "_" + imageType + "</td>";
        }
        else {
            tableHTML += pidNo + "_" + imageType + "</td>";
        } 
    }
    else if (typeOfImages == 3 || typeOfImages == 4) {
        tableHTML += "<td class='columns' style='background-color: lightgrey;'><IMG SRC='" + imageFileLocation() + "'><BR>";
        if (site == "mrp") {
            if (typeOfImages != 4) {
                tableHTML += arUserDefinedPIDs[i] + "_" + site + "_" + arDefaultImageTypes[a] + "</td>";
            }
            else {
                tableHTML += arUserDefinedPIDs[i] + "_" + site + "_" + imageType + "</td>";
            }
        }
        else {
            if (typeOfImages != 4) {
                tableHTML += arUserDefinedPIDs[i] + "_" + arDefaultImageTypes[a] + "</td>";
            }
            else {
                tableHTML += arUserDefinedPIDs[i] + "_" + imageType + "</td>";
            }
        } 
    }
     else if (typeOfImages == 5) {
        if (a == 0) {
        tableHTML += "<td class='columns' style='background-color: lightgrey;'><SPAN><B>" + arFulcrumDesignerPIDs[i] + "</B></SPAN><BR><SPAN style='font-size: smaller;'>" + arFulcrumProductDescriptionPIDs[i] + "</SPAN><BR><SPAN style='font-size: small;'>Colour: " + arFulcrumColourPIDs[i] + "</SPAN><BR><BR><I><SPAN style='font-size: small;'>" + arFulcrumProductNotesPIDs[i] + "</I><BR><BR></SPAN><SPAN style='font-size: smaller;'>" + arFulcrumCategoryPIDs[i] + "</SPAN><BR><SPAN style='font-size: small;'>" + arFulcrumSubcategoryPIDs[i] + "</SPAN>";
        }
        else {
         tableHTML += "<td class='columns' style='background-color: lightgrey;'><IMG SRC='" + imageFileLocation() + "'><BR>";
        if (site == "mrp") {
            tableHTML += arFulcrumPIDs[i] + "_" + site + "_" + arDefaultImageTypesFulcrum[a] + "</td>";
        }
        else {
            tableHTML += arFulcrumPIDs[i] + "_" + arDefaultImageTypesFulcrum[a] + "</td>";
        } 
        }
    }
    
    
}

function beginHTML() {
    console.log("test")
    if (subSite == "fulcrum") {
         return "<table class='tg' style='text-align: center; font-size: 300%; font-family: Georgia; border: 1px solid black;'><tr><th class='header'>Description</th><th class='header'>IN</th><th class='header'>RW</th><th class='header'>FR</th><th class='header'>BK</th><th class='header'>OU</th><th class='header'>OU2</th><th class='header'>OU3</th><th class='header'>CU</th><th class='header'>E1</th><th class='header'>E2</th><th class='header'>E3</th><th class='header'>E4</th><th class='header'>E5</th><th class='header'>E6</th><th class='header'>E7</th><th class='header'>E8</th><th class='header'>SW</th><th class='header'>Buying Image 1</th><th class='header'>Buying Image 2</th><th class='header'>Buying Image 3</th></tr><tr>";
    }
    else if (typeOfImages == 1 || typeOfImages == 3 || typeOfImages ==5) {
        return "<table class='tg' style='text-align: center; font-size: 300%; font-family: Georgia; border: 1px solid black;'><tr><th class='header'>IN</th><th class='header'>RW</th><th class='header'>FR</th><th class='header'>BK</th><th class='header'>OU</th><th class='header'>OU2</th><th class='header'>OU3</th><th class='header'>CU</th><th class='header'>E1</th><th class='header'>E2</th><th class='header'>E3</th><th class='header'>E4</th><th class='header'>E5</th><th class='header'>E6</th><th class='header'>E7</th><th class='header'>E8</th><th class='header'>SW</th></tr><tr>";
    }
    else {
            return "<table class='tg' style='text-align: center; font-size: 300%; font-family: Georgia; border: 1px solid black;'><tr>";    

        }
    
}

function findPid() {
    if (site == "ton") {     
        var pidsPath = document.getElementsByClassName('list-item')[i].href;
        var pidsFull = pidsPath.replace(/^.*[\\\/]/, '');   
        return pidsFull.slice(0,6);         
    }
    if (site == "mrp") {
        if (document.getElementsByClassName('pl-products-item__link').length > 1) {
            var pidsPath = document.getElementsByClassName(imageClass)[i].href; 
        }
        else {
            var pidsPath = document.getElementsByClassName(imageClass)[i].childNodes[1].childNodes[1].src;
        }
           
        var pidsFull = pidsPath.replace(/^.*[\\\/]/, '');         
        return pidsFull.slice(0,6);
        
    }
    if (site == "nap") {
       
        var pidsPath = document.getElementsByClassName(imageClass)[i].childNodes[1].pathname;
       
        if (pidsPath.slice(0,8) == '/product') {
            var pidsFull = pidsPath.replace('/product/', '');    
            
        }
        else {
            var pathArray = window.location.pathname.split( '/' );
            var pidsFull = pidsPath.replace("/" + pathArray[1] + "/" + pathArray[2] + "/product/", '');
        }

        return pidsFull.slice(0,6);
        
    }
    
}

function imageFileLocation() {
    
     if (a == 17) {
         return "http://fulcrum.net-a-porter.com/static/images/product/" + arFulcrumPIDs[i] + "/" + "100.jpg?" + escape(new Date());
     }
     else if (a == 18) {
          return "http://fulcrum.net-a-porter.com/static/images/product/" + arFulcrumPIDs[i] + "/" + "200.jpg?" + escape(new Date());
     }
     else if (a == 19) {
         return "http://fulcrum.net-a-porter.com/static/images/product/" + arFulcrumPIDs[i] + "/" + "300.jpg?" + escape(new Date());
     }
    
    else if (site == "ton") {   http://ton
        if (typeOfImages == 1) {
             return "http://cache.theoutnet.com/images/products/" + pidNo + "/" + pidNo + "_" + arDefaultImageTypes[a] + "_pp.jpg?" + escape(new Date());
        }
        else if (typeOfImages == 2) {
            return "http://cache.theoutnet.com/images/products/" + pidNo + "/" + pidNo + "_" + imageType + "_pp.jpg?" + escape(new Date());
        }    
         else if (typeOfImages == 3) {
             return "http://cache.theoutnet.com/images/products/" + arUserDefinedPIDs[i] + "/" + arUserDefinedPIDs[i] + "_" + arDefaultImageTypes[a] + "_pp.jpg?" + escape(new Date());
        }
        else if (typeOfImages == 4) {
             return "http://cache.theoutnet.com/images/products/" + arUserDefinedPIDs[i] + "/" + arUserDefinedPIDs[i] + "_" + imageType + "_pp.jpg?" + escape(new Date());
        }
         else if (typeOfImages == 5) {
             return "http://cache.theoutnet.com/images/products/" + arFulcrumPIDs[i] + "/" + arFulcrumPIDs[i] + "_" + arDefaultImageTypesFulcrum[a] + "_pp.jpg?" + escape(new Date());
        }
        
    }
        
    else if (site == "mrp") {  http://mrP
         if (typeOfImages == 1) {
             return "http://cache.mrporter.com/images/products/" + pidNo + "/" + pidNo + "_" + "mrp" + "_" + arDefaultImageTypes[a] + "_xl.jpg?" + escape(new Date());
        }
        else if (typeOfImages == 2) {
           return "http://cache.mrporter.com/images/products/" + pidNo + "/" + pidNo + "_" + "mrp" + "_" + imageType + "_xl.jpg?" + escape(new Date());
        }    
         else if (typeOfImages == 3) {
            return "http://cache.mrporter.com/images/products/" + arUserDefinedPIDs[i] + "/" + arUserDefinedPIDs[i] + "_" + "mrp" + "_" + arDefaultImageTypes[a] + "_xl.jpg?" + escape(new Date()); 
        }
         else if (typeOfImages == 4) {
            return "http://cache.mrporter.com/images/products/" + arUserDefinedPIDs[i] + "/" + arUserDefinedPIDs[i] + "_" + "mrp" + "_" + imageType + "_xl.jpg?" + escape(new Date()); 
        }
        else if (typeOfImages == 5) {
            return "http://cache.mrporter.com/images/products/" + arFulcrumPIDs[i] + "/" + arFulcrumPIDs[i] + "_" + "mrp" + "_" + arDefaultImageTypesFulcrum[a] + "_xl.jpg?" + escape(new Date()); 
        }
        
    }
    else if (site == "nap") {    http://nap
         if (typeOfImages == 1) {
             return "http://cache.net-a-porter.com/images/products/" + pidNo + "/" + pidNo + "_" + arDefaultImageTypes[a] + "_pp.jpg?" + escape(new Date());
        }
        else if (typeOfImages == 2) {
            return "http://cache.net-a-porter.com/images/products/" + pidNo + "/" + pidNo + "_" + imageType + "_pp.jpg?" + escape(new Date());
        }    
         else if (typeOfImages == 3) {
             return "http://cache.net-a-porter.com/images/products/" + arUserDefinedPIDs[i] + "/" + arUserDefinedPIDs[i] + "_" + arDefaultImageTypes[a] + "_pp.jpg?" + escape(new Date());
        }
        else if (typeOfImages == 4) {
             return "http://cache.net-a-porter.com/images/products/" + arUserDefinedPIDs[i] + "/" + arUserDefinedPIDs[i] + "_" + imageType + "_pp.jpg?" + escape(new Date());
        }
         else if (typeOfImages == 5) {
             return "http://cache.net-a-porter.com/images/products/" + arFulcrumPIDs[i] + "/" + arFulcrumPIDs[i] + "_" + arDefaultImageTypesFulcrum[a] + "_pp.jpg?" + escape(new Date());
        }
    }
    
}







// window.MRP_PL.state.listing.metadata.categories  Could you cycle through categories? Although this array is a dead end.

// window.MRP_PL.state.listing.products.items[1].leafCategoryIds[0]  Use to get category? Could lead to the Rollover.
*/
